<ng-container *transloco="let t; read: 'signup'">
  <mat-card class="form-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon [inline]="true">assignment</mat-icon>
        <span>{{ t('signupTitle') }}</span>
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form
        [formGroup]="form"
        (submit)="onSubmit()"
        class="form"
        autocomplete="off"
      >
        <mat-form-field
          appearance="outline"
          [customErrors]="usernameErrorMessages"
          [excludedErrors]="['checking']"
        >
          <mat-label>{{ t('user') }}</mat-label>
          <input
            autofocus
            matInput
            type="text"
            formControlName="username"
            required
          />
          <span matSuffix>
            <mat-spinner
              *ngIf="form.controls['username']?.pending"
              [diameter]="20"
            ></mat-spinner>
            <mat-icon
              *ngIf="form.controls['username'].valid"
              style="color: green"
              >check_circle_outline</mat-icon
            >
          </span>

          <!-- <mat-error
            *ngIf="form.controls['username']?.hasError('unavailable')"
            >{{ t('unavailableUsername') }}</mat-error
          >
          <mat-error
            *ngIf="
              form.controls['username']?.hasError('minlength') ||
              form.controls['username']?.hasError('maxlength')
            "
            >{{ t('minMaxLength', { min: '4', max: '20' }) }}
          </mat-error> -->
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>{{ t('mail') }}</mat-label>
          <input
            matInput
            [placeholder]="t('mail')"
            formControlName="email"
            required
          />
          <mat-error *ngIf="form.controls['email']?.hasError('email')">{{
            t('unavailableUsername')
          }}</mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>{{ t('password') }}</mat-label>
          <input
            matInput
            [placeholder]="t('password')"
            formControlName="password"
            type="password"
            required
          />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>{{ t('repeatPassword') }}</mat-label>
          <input
            matInput
            [placeholder]="t('repeatPassword')"
            formControlName="password2"
            type="password"
            required
          />
        </mat-form-field>

        <button class="mat-primary mat-raised-button btn--big" type="submit">
          {{ 'submit' | transloco }}
        </button>

        <div>
          {{ form | formErrorsJson | json }}
        </div>
      </form>
    </mat-card-content>
    <mat-card-footer>
      <h3>¿Ya estás registrado?</h3>
      <a [routerLink]="['/home', 'login']" routerLinkActive="router-link-active"
        >Inicia sesión</a
      >
    </mat-card-footer>
  </mat-card>
</ng-container>
