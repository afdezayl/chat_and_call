<chat-and-call-chat-header></chat-and-call-chat-header>
<mat-sidenav-container autosize>
  <mat-sidenav #sidenav mode="side" opened>
    <h2>Channels</h2>
    <ng-container *ngIf="channels$ | async as channels">
      <div *ngFor="let channel of channels">
        <button (click)="setFocus(channel.id)">
          {{ channel.title }}
        </button>
      </div>
    </ng-container>
  </mat-sidenav>
  <mat-sidenav-content *ngIf="focus$ | async as focus">
    <h2>{{ focus | json }}</h2>
    <p>Count : {{ newMessagesCount }}</p>
    <div #message_container class="chat">
      <chat-and-call-message
        *ngFor="let m of messages$ | async"
        [message]="m"
        (viewed)="onViewed($event)"
      >
      </chat-and-call-message>
      <!-- <p *ngFor="let m of messages">
        {{ m | json }}
      </p> -->
    </div>
    <form [formGroup]="messageForm" (submit)="sendMessage(focus.id)">
      <input type="text" formControlName="text" />
      <button type="submit">Enviar</button>
      <input type="file" formControlName="file" />

      {{ messageForm.value | json }}
    </form>
  </mat-sidenav-content>
</mat-sidenav-container>
